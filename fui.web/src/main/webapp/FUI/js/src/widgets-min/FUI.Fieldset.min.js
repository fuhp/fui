(function(a){a.registerWidgetEvent("onExpand,onCollapse");a.widget("FUI.FFieldset",{options:{width:"auto",height:"auto",autoscroll:true,onCollapse:null,onExpand:null,_isCollapsed:false,_isNeedResize:false,_objHeader:null,_objHeaderToggle:null,_objHeaderText:null,_objBodyWrapper:null,_bodyWrapperHGaps:38,_bodyWrapperWGaps:28},_create:function(){var b=this.element.attr("id");var d=this.element;var c=this.options;c.id=b;c._objHeader=$I(b+"-legend");c._objHeaderToggle=$I(b+"-toggle");c._objHeaderToggle.css("float","left");c._objHeaderToggle.css("margin","2px");c._objHeaderText=$I(b+"-title");c._objBodyWrapper=$I(b+"-bwrap");c._isCollapsed=this.element.hasClass("f-collapsed");c._isNeedResize=c._isCollapsed;if(!c._isNeedResize){c._bodyWrapperHGaps=d.outerHeight(false)-c._objBodyWrapper.height();c._bodyWrapperWGaps=d.outerWidth(false)-c._objBodyWrapper.width()}this._bindEvent()},_init:function(){this.setSize(this.options.width,this.options.height)},_bindEvent:function(){var c=this;var b=this.options._objHeaderToggle;b.hover(function(d){b.addClass("f-tool-toggle-over")},function(d){b.removeClass("f-tool-toggle-over")});b.click(function(){if(c.options._isCollapsed){c.expand()}else{c.collapse()}return false})},destroy:function(){this.options._objHeaderToggle.unbind();this.options._objHeader=null;this.options._objHeaderToggle=null;this.options._objHeaderText=null;this.options._objBodyWrapper=null;a.Widget.prototype.destroy.call(this)},expand:function(){var b=this;var d=this.element;var c=b.options;if(c._isCollapsed){c._objBodyWrapper.slideDown("fast",function(){b.element.addClass("f-collapsible").removeClass("f-collapsed");c._isCollapsed=false;if(c._isNeedResize){c._bodyWrapperHGaps=d.outerHeight(false)-c._objBodyWrapper.height();c._bodyWrapperWGaps=d.outerWidth(false)-c._objBodyWrapper.width();b.setSize(c.width,c.height);c._isNeedResize=false}if(c.autoscroll){c._objBodyWrapper.css("overflow","auto")}var f=true;if(a.isFunction(c.onExpand)){var e=c.onExpand.call(b);f=(e===false)?false:true}if(f){b.element.triggerHandler("onExpand")}a(this).css({zoom:1})})}},collapse:function(){var b=this;var c=b.options;if(!c._isCollapsed){c._objBodyWrapper.slideUp("fast",function(){b.element.removeClass("f-collapsible").addClass("f-collapsed");c._isCollapsed=true;var e=true;if(a.isFunction(c.onCollapse)){var d=c.onCollapse.call(b);e=(d===false)?false:true}if(e){b.element.triggerHandler("onCollapse")}})}},setTitle:function(b){if(b){this.options.title=b;this.options._objHeaderText.text(b)}},setSize:function(k,e){var g=window["$Utils"];var f=this.options;var i=this.element;var m=f._objBodyWrapper;var j=m.children(".f-panel-body-content");var b=j.size();if(k){var l=g.getPercentage(k);if(l){i.get(0).style.width=l;m.get(0).style.width="auto";if(b===1){j.get(0).style.width="auto"}}else{var c=f._bodyWrapperWGaps;k=parseInt(k);var n=k-c;if(!isNaN(n)){if(n<0){n=0}i.get(0).style.width=n+"px";if(b===1){j.get(0).style.width=n+"px"}else{m.get(0).style.width=n+"px"}}}}if(e){var l=g.getPercentage(e);if(l){i.get(0).style.height=l;m.get(0).style.height="auto";if(b===1){j.get(0).style.height="auto"}}else{var c=f._bodyWrapperHGaps;var n=parseInt(e)-c;if(!isNaN(n)){if(n<0){n=0}if(b===1){var d=0;j.siblings().not("script").each(function(){d+=a(this).outerHeight(true)});n=(n-d)<0?0:(n-d);j.get(0).style.height=n+"px"}else{m.get(0).style.height=n+"px"}i.get(0).style.height="auto"}}}}})})(jQuery);