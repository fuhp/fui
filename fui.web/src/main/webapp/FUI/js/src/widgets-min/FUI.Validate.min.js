(function(a){a.extend(a.fn,{FValidate:function(c){if(!this.length){c&&c.debug&&window.console&&console.warn("nothing selected, can't validate, returning nothing");return}var d=a.data(this[0],"validator");if(d){return d}this.attr("novalidate","novalidate");if(c.onkeyup){delete c.onkeyup}if(c.onclick){delete c.onclick}if(c.onfocusout){delete c.onfocusout}if(c.onsubmit){delete c.onsubmit}if(!c.errorPlacement){if("qtip"===c.errorModel){c.errorMsgClass="f-validate-errorMsg";c.errorElement="label";c.errorPlacement=function(g,h){if(g.html()){var k=a(h);var l=a("#fui-validate-qtip-msg");if(!l.length){a("body").append("<span id='fui-validate-qtip-msg' class='f-validate-errorMsg' style='display:none;' />")}var j=k.attr("errorMsgTarget");if(j){if("parent"==j){var i=k.parent();i.attr("f-validate-qtip-msg",g.html())}else{j=a.trim(j);if(j.indexOf("#")!==0){j="#"+j}var i=a(j);i.attr("f-validate-qtip-msg",g.html())}}else{k.attr("f-validate-qtip-msg",g.html())}}};c.showErrors=function(g,h){if(h&&h.length>0){a.each(h,function(i,m){var n=this.message;var l=a(m.element);var k=l.attr("errorMsgTarget");if(l.attr("hasbindmouseevent")!=="true"){if(k){var j=null;if("parent"==k){j=l.parent()}else{k=a.trim(k);if(k.indexOf("#")!==0){k="#"+k}j=a(k)}j.bind("mouseover",function(r){var q=a("#fui-validate-qtip-msg");var o=a(this);var s=o.attr("f-validate-qtip-msg");var p=o.attr("valid");if(p!=="true"&&q.length){q.html(s);q.css("display","inline").css({top:r.pageY+10,left:r.pageX+5})}}).bind("mouseout",function(){var o=a("#fui-validate-qtip-msg");if(o.length){o.css("display","none")}})}else{l.bind("mouseover",function(r){var q=a("#fui-validate-qtip-msg");var o=a(this);var s=o.attr("f-validate-qtip-msg");var p=o.attr("valid");if(p!=="true"&&q.length){q.html(s);q.css("display","inline").css({top:r.pageY+10,left:r.pageX+5})}}).bind("mouseout",function(){var o=a("#fui-validate-qtip-msg");if(o.length){o.css("display","none")}})}l.attr("hasbindmouseevent",true)}})}else{a(this.currentElements).parents().map(function(){if(this.tagName.toLowerCase()=="td"){a(this).children().eq(0).removeClass("error-border")}else{a(this).removeClass("error-border")}a(this).children().eq(0).removeClass("x-form-invalid")})}this.defaultShowErrors()}}else{c.errorPlacement=function(g,h){if(g.html()){var k=a(h);var j=k.attr("errorMsgTarget");if(j){if("parent"==j){var i=k.parent();g.insertAfter(i);g.css("display","none")}else{j=a.trim(j);if(j.indexOf("#")!==0){j="#"+j}var i=a(j);g.insertAfter(i);g.css("display","none")}}else{g.insertAfter(k);g.css("display","none")}}}}}d=new a.fvalidator(c,this[0]);a.data(this[0],"validator",d);if(d.settings.onsubmit){var b=this.find("input");var e=this.find("button");var f=b.add(e);f.filter(".cancel").click(function(){d.cancelSubmit=true});if(d.settings.submitHandler){f.filter(":submit").click(function(){d.submitButton=this})}this.submit(function(g){if(d.settings.debug){g.preventDefault()}function h(){if(d.settings.submitHandler){if(d.submitButton){var i=a("<input type='hidden'/>").attr("name",d.submitButton.name).val(d.submitButton.value).appendTo(d.currentForm)}d.settings.submitHandler.call(d,d.currentForm);if(d.submitButton){i.remove()}return false}return true}if(d.cancelSubmit){d.cancelSubmit=false;return h()}if(d.form()){if(d.pendingRequest){d.formSubmitted=true;return false}return h()}else{d.focusInvalid();return false}})}return d},isValidate:function(f){if(f){var e=$I(f);if(e.length>0){var d=false;var c=e.validate();d=c.element(this);return d}else{return true}}else{var d=false;var b=this[0];if(b.form){var c=a.data(b.form,"validator");if(c){d=c.element(this);return d}else{return true}}else{return true}}}});a.fvalidator=function(b,c){this.settings=a.extend(true,{},a.fvalidator.defaults,b);this.currentForm=c;this.init()};a.extend(a.fvalidator,{prototype:a.validator.prototype,defaults:{messages:{},groups:{},rules:{},errorClass:"f-validate-error",validClass:"valid",errorElement:"div",errorModel:"under",focusInvalid:true,errorContainer:a([]),errorLabelContainer:a([]),onsubmit:true,ignore:[],ignoreTitle:false,onfocusin:function(d,e){var f=a(d);var g=f.attr("hasprevioussbling");var c=f.attr("hasChecked");if(!c){if(g=="true"){var b=f.prev()[0];this.check(b)}else{this.check(d)}f.attr("hasChecked","true")}this.lastActive=d;if(this.settings.focusCleanup&&!this.blockFocusCleanup){this.settings.unhighlight&&this.settings.unhighlight.call(this,d,this.settings.errorClass,this.settings.validClass);if(g==="true"){var b=f.prev()[0];this.addWrapper(this.errorsFor(b)).hide()}else{this.addWrapper(this.errorsFor(d)).hide()}}},onfocusout:function(c,d){var e=a(c);if(e.attr("hasprevioussbling")==="true"){var b=e.prev()[0];if(!this.checkable(b)&&(b.name in this.submitted||!this.optional(b))){this.element(b)}}else{if(!this.checkable(c)&&(c.name in this.submitted||!this.optional(c))){this.element(c)}}},onkeyup:function(b,c){if(this.keyUpTimeout){clearTimeout(this.keyUpTimeout)}_this=this;this.keyUpTimeout=setTimeout(function(){var e=a(b);if(e.attr("hasprevioussbling")==="true"){var d=a(b).prev()[0];if(d.name in _this.submitted||d==_this.lastElement){_this.element(d)}}else{if(b.name in _this.submitted||b==_this.lastElement){_this.element(b)}}},300)},onclick:function(b,c){if(b.name in this.submitted){this.element(b)}else{if(b.parentNode.name in this.submitted){this.element(b.parentNode)}}},highlight:function(e,b,d){if(e.type==="radio"){this.findByName(e.name).addClass(b).removeClass(d)}else{var h=a(e);var i=h.attr("errorValidateTarget");var g=h.attr("errorMsgTarget");if(!i){h.addClass(b).removeClass(d)}else{if("next"===i){var c=h.next();c.addClass(b).removeClass(d)}else{a(i).addClass(b).removeClass(d)}}if("parent"==g){var f=h.parent();f.attr("valid","false")}else{h.attr("valid","false")}}},unhighlight:function(e,b,d){if(e.type==="radio"){this.findByName(e.name).removeClass(b)}else{var h=a(e);var i=h.attr("errorValidateTarget");var g=h.attr("errorMsgTarget");if(!i){h.removeClass(b).addClass(d)}else{if("next"===i){var c=h.next();c.removeClass(b).addClass(d)}else{a(i).removeClass(b).addClass(d)}}if("parent"==g){var f=h.parent();f.attr("valid","true")}else{h.attr("valid","true")}}}}})})(jQuery);