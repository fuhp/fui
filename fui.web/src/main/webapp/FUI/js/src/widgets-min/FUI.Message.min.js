(function(a){a.registerWidgetEvent("");a.widget("FUI.FMessage",{options:{onBntClick:null,onCloseClick:null},_create:function(){this.options.id=this.element.attr("id")},_init:function(){var b=this;var c=this.element;if(!$Component.hasFType(c,"FPopupBox")){c.FPopupBox({position:{left:"center",top:"center"},zIndex:20001})}b._bindEvent()},destroy:function(){var b=this.options;if(b._dragable){b._dragable.stop();b._dragable.destroy();b._dragable=null}a.Widget.prototype.destroy.call(this)},_bindEvent:function(){var d=this.options;var b=this;var c=this.element;b._bindBntsEvent();b._bindCloseBntEvent();b._bindHeaderEvent()},_bindBntsEvent:function(){var d=this;var g=[d._getOkEl(),d._getYesEl(),d._getNoEl(),d._getCancelEl()];var c=["ok","yes","no","cancel"];for(var e=0;e<g.length;e++){var b=c[e];var f=a.proxy(d.options,"onBntClick",b);g[e].FSimpleButton({onClick:f})}},_bindCloseBntEvent:function(){var b=this;var c=b._getCloseIconEl();c.hover(function(){a(this).addClass("f-tool-closethick").removeClass("f-tool-close")},function(){a(this).removeClass("f-tool-closethick").addClass("f-tool-close")}).mousedown(function(d){d.stopPropagation()}).click(function(){b.options.onCloseClick()})},_bindHeaderEvent:function(){var b=this;var e=this.options;var d=this.element;var c=b._getHeaderEl();e._dragable=new a.Dragable(e.id+"-header",e.id)},_getHeaderEl:function(){var d=this.options;var b=d._headerEl;if(!b){var c=this.element;d._headerEl=b=$I(d.id+"-header")}return b},_getCloseIconEl:function(){var c=this.options;var b=c._closeEl;if(!b){c._closeEl=b=$I(c.id+"-closeIcon")}return b},_getOkEl:function(){var c=this.options;var b=c._okBntEl;if(!b){b=c._okBntEl=$I(c.id+"-okBnt")}return b},_getCancelEl:function(){var c=this.options;var b=c._cancelBntEl;if(!b){b=c._cancelBntEl=$I(c.id+"-cancelBnt")}return b},_getYesEl:function(){var c=this.options;var b=c._yesBntEl;if(!b){b=c._yesBntEl=$I(c.id+"-yesBnt")}return b},_getNoEl:function(){var c=this.options;var b=c._noBntEl;if(!b){b=c._noBntEl=$I(c.id+"-noBnt")}return b},show:function(b){this.element.FPopupBox("show",b)},hide:function(b){this.element.FPopupBox("hide",b)}});a.FMessage={_status:{type:"",choise:"",text:""},_cmdQueue:[],_isShow:false,_options:{},OK:1,OKCANCEL:4097,YES:16,NO:256,YESNO:272,CANCEL:4096,YESNOCANCEL:4368,INFO:"f-message-icon-info",QUESTION:"f-message-icon-question",WARNING:"f-message-icon-warning",ERROR:"f-message-icon-error",alert:function(d,c,e){var b=this;b.show({title:d,msg:c,callback:e,buttons:b.OK,width:"250px"})},confirm:function(d,c,e){var b=this;b.show({title:d,msg:c,callback:e,buttons:b.YESNO,icon:b.QUESTION,width:"280px"})},prompt:function(d,c,e){var b=this;b.show({title:d,msg:c,callback:e,buttons:b.OKCANCEL,prompt:true,width:"250px"})},show:function(h){var c=this;var d=c._getMessageEl();if(c._isShow){c._cmdQueue.push(h);return}c._isShow=true;var g=h.title||"&nbsp;";c._getElement("title").html(g);var f=c._resetButtons(h.buttons,h.buttonTexts);var e="345px";if(h.width){e=h.width}else{if(f==1){e="250px"}else{if(f==2){e="280px"}else{if(f>=3){e="345px"}}}}d.width(e);c._resetBody(h,e);var b=c._getElement("closeIcon");if(h.closeIcon===false){b.css("display","none")}else{b.css("display","block")}c._showMask();d.FMessage("show",{show:{callback:function(){a(document).bind("keydown.FMessage",function(i){if(i.which==27){c._bntClick("cancel")}})}},hide:{callback:function(){c._hideMask();a(document).unbind("keydown.FMessage");c._status.text=c._getElement("promptInput").val();if(a.isFunction(h.callback)){h.callback(c._status.choise,c._status.text)}c._isShow=false;c._processQueue()}}})},_processQueue:function(){var c=this;var b=c._cmdQueue;if(b.length==0){return}c.show(b.shift())},_showMask:function(){a("body").doMask("please choose!",{showImg:false})},_hideMask:function(){a("body").doUnMask()},hide:function(){var b=this;var c=b._getMessageEl();c.FMessage("hide")},_resetBody:function(e,b){b=parseInt(b);var l=this;var f=e.icon;var d=e.msg||"&nbsp;";var c=l._getElement("content");var i=l._getElement("iconContent");var h=l._getElement("prompt");if(e.prompt==true){c.css("display","none");h.css("display","block");i.css("display","none");l._getElement("promptMsg").html(d);l._getElement("promptInput").val("")}else{if(f){var k=[l.INFO,l.QUESTION,l.WARNING,l.ERROR];c.css("display","none");h.css("display","none");i.css("display","block");var j=l._getElement("tipIcon");j.removeClass(k.join(" "));j.addClass(f);var g=l._getElement("tipContent");if(!isNaN(b)){g.width(b-20-50)}g.html(d)}else{c.css("display","block");h.css("display","none");i.css("display","none");l._getElement("content").html(d)}}},_resetButtons:function(e,b){var c=this;e=e||0;if(e==0){var d=c._getElement("buttonGroup");d.css("display","none");return 0}else{b=b||{};c._getElement("buttonGroup").css("display","block");var f=0;a.each(["ok","yes","no","cancel"],function(h,g){var j=c._getElement(g+"Bnt-wrapper");if(e&c[g.toUpperCase()]){if(b[g]){c._getElement(g+"Bnt").text(b[g])}j.parent().show();f++}else{j.parent().hide()}});return f}},_getElement:function(b){var d=this._options;var c=d["_obj"+b+"El"];if(c){return c}else{c=d["_obj"+b+"El"]=$I(d.id+"-"+b)}return c},_bntClick:function(c){var b=this;b._status.choise=c;b.hide()},_getMessageEl:function(){var b=this;var e=b._options;if(e.id){return $I(e.id)}else{var d=$Utils.genId("f-message");var c=b._generateHtml({id:d,title:("FMessage"+$Utils.UID)});a("body").append(c);$I(d).FMessage({onBntClick:function(f){b._bntClick(f)},onCloseClick:function(){b._bntClick("cancel")}});e.id=d}return a("#"+d)},_generateHtml:function(i){var c=this;var h=i.id||$Utils.genId("f-message");var e=i.width||"350px";var f=i.title||"&nbsp;";var g=c._genContentHtml(h);var b=c._genButtonGroup(h);var d="			<div id='{0}' class='f-message f-popupMessage f-widget f-corner-all' style='width:{1};'> 			  <div id='{0}-header' class='f-popupMessage-header f-form-unselectable f-message-header' onselectstart='return false;'> 			  	<span id='{0}-title'>{2}</span> 			    <span id='{0}-closeIcon' class='f-popupMessage-icon f-tool f-tool-close'>&nbsp;</span> 			  </div> 			  <div id='{0}-body' class='f-popupMessage-body'>{3}</div> 			  {4} 			</div>";return $Utils.format(d,h,e,f,g,b)},_genContentHtml:function(c){var b="";b+=" 				<div id='{0}-content' style='margin-bottom:5px;'>&nbsp;</div> 			";b+="				<div id='{0}-iconContent'>					<div id='{0}-tipIcon' style='width:50px;height:35px;float:left;' class='f-message-icon-question'>&nbsp;</div>					<div id='{0}-tipContent' style='float:left'>&nbsp;</div>					<div class='f-form-clear'></div>				</div>";b+=" 				<div id='{0}-prompt'> 					<div id='{0}-promptMsg' style='margin-bottom:3px;'>&nbsp;</div> 					<input type='text' class='f-textInput f-textField' id='{0}-promptInput' style='margin-bottom:5px;'> 				</div>";return $Utils.format(b,c)},_genButtonGroup:function(c){var b=this;return a.FUI.FButtonGroup.generateHtml({id:c+"-buttonGroup",toolspacing:"2",style:"margin-top: 5px;",items:[a.FUI.FSimpleButton.generateHtml({text:"OK",id:c+"-okBnt",height:"22px",style:"margin: 0px 3px"}),a.FUI.FSimpleButton.generateHtml({text:"Yes",id:c+"-yesBnt",height:"22px",style:"margin: 0px 3px"}),a.FUI.FSimpleButton.generateHtml({text:"No",id:c+"-noBnt",height:"22px",style:"margin: 0px 3px"}),a.FUI.FSimpleButton.generateHtml({text:"Cancel",id:c+"-cancelBnt",height:"22px",style:"margin: 0px 3px"})]})}}})(jQuery);